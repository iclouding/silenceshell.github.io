---
layout: post
title: "外行的Spark机器学习笔记（一）：word2vec"
date: 2016-11-10 00:11:12
author: 伊布
categories: tech
tags: spark
cover:  "/assets/instacode.png"
---

工作需要，进了机器学习的坑，发现需要一定的数学功底。由于我们属于工具的层次，所以现在不准备深入理解ML的细节，对于spark的ml以了解、会用为主，不涉及其实现。

Spark版本为1.6.1。目前spark的机器学习库分为ml和mllib，从字面意义上来看，mllib更底层一些，实际上mllib主要操作的是RDD，而ml则操作DataFrame，相对来说ml的层次更高，使用起来更方便。我们选择在ml上做开发工作。

先来看看特征工程里文本处理的word2vec。

### 文本处理

思考这么一个问题：怎么知道跟一个词比较接近的有哪些词？比如说苹果，接近的可能是iphone，安卓，等等。一个简单的想法是从互联网上查询若干新闻，根据上下文来判断其相关性，并以特征向量来表示不同的词，简单来说这就是word2vec的思路。

#### Example

Spark给的是这么一个例子。

```scala
import org.apache.spark.ml.feature.Word2Vec

// Input data: Each row is a bag of words from a sentence or document.
val documentDF = sqlContext.createDataFrame(Seq(
  "Hi I heard about Spark".split(" "),
  "I wish Java could use case classes".split(" "),
  "Logistic regression models are neat".split(" ")
).map(Tuple1.apply)).toDF("text")

// Learn a mapping from words to Vectors.
val word2Vec = new Word2Vec()
  .setInputCol("text")
  .setOutputCol("result")
  .setVectorSize(3)
  .setMinCount(0)
val model = word2Vec.fit(documentDF)
val result = model.transform(documentDF)
result.select("result").take(3).foreach(println)
```

一开始我是懵逼的，fit得到了model，然后用这个model去transform原始的句子是什么意思？
--其实我觉得这个例子给的并不好。上面的代码做了3件事：

1. 初始化语料
2. 根据语料去做word2vec模型的fit（训练）
3. fit的model的应用

一般来说，语料最好丰富一些，否则训练出来的模型使用非常受限制：





